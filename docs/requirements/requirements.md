# 要件定義書

## 要件 1 アプリケーション機能

1. ユーザーは技術ブログ/ドキュメントの更新を一覧で閲覧できる。
2. 各記事の要約は 1 文で表示され、日本語訳を提供する。
3. 記事の原文リンク・公開日時・タグを確認できる。
4. 翻訳や要約でエラーが発生した場合でも、一覧は崩れず原文情報でフォールバックする。

## 要件 2 データ取得とキャッシュ

1. RSS/Atom/JSON Feed から 1 日単位で記事を収集できる。
2. 取得した記事は Firestore にキャッシュされ、既読データの再取得を最小化する。
3. キャッシュは 6 時間を目安に期限管理される。
4. 手動/自動で要約キャッシュを再生成できる。

## 要件 3 ホスティングと配信

1. Next.js アプリは Firebase Hosting（App Hosting）で配信する。
2. ステージング・本番を Firebase Hosting の複数サイトで切り替え管理できる。
3. デプロイは `firebase deploy --only hosting` で完結する。
4. カスタムドメインは任意とし、必要に応じて Firebase Hosting のガイドに従って設定できる。

## 要件 4 運用・監視

1. 日次でサイト表示と要約の更新状況を確認できるチェックリストを提供する。
2. Firestore のキャッシュ状況は Firebase コンソールで確認し、必要に応じて削除/再生成できる。
3. GitHub Actions の実行ログからキャッシュウォーミングの成否を確認できる。
4. コストと課金通知は Firebase / Google Cloud Console の標準機能で確認する。

## 要件 5 自動処理

1. GitHub Actions を用いて 1 時間ごとに `scripts/fetch-feeds.mjs` を実行し、最新データをウォームアップする。
2. 手動実行時は `force_refresh` オプションでキャッシュを更新できる。
3. 自動処理に必要なシークレットは GitHub Secrets で管理する。

## 要件 6 セキュリティ

1. Firestore への書き込みはサーバーサイド（Next.js API）に限定する。
2. Firestore Security Rules でキャッシュ読み取りを認証済みリクエストに限定する（必要に応じて公開設定を検討）。
3. API キーやサービスアカウントは `.env` と GitHub Secrets で管理し、リポジトリに直接含めない。

## 要件 7 パフォーマンスと UX

1. 一覧表示は 1 秒以内のレスポンスを目標とし、ローディング表示を実装する。
2. モバイル/デスクトップ双方でのレイアウト最適化を行う。
3. 30 件以上の記事を段階的に表示できる無限スクロールまたはページネーションを用意する。

## 要件 8 ドキュメント

1. セットアップ手順（Firebase プロジェクト設定、環境変数準備、デプロイ手順）を README / `docs/requirements/setup.md` に明記する。
2. 運用手順（日次/週次チェック、GitHub Actions 手動実行方法）を `docs/operation/operations.md` にまとめる。
3. アーキテクチャとデータフローは `docs/design/design.md` で図示する。
4. 変更履歴は Git によって追跡可能とし、重大な環境変更はドキュメント化する。
